"use strict";(globalThis.webpackChunkai_book=globalThis.webpackChunkai_book||[]).push([[9899],{624:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>p,contentTitle:()=>m,default:()=>g,frontMatter:()=>u,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"module1-ros2/lesson3","title":"ROS 2 Communication: Topics, Services, and Actions","description":"Dive deeper into the core communication mechanisms of ROS 2.","source":"@site/docs/module1-ros2/lesson3.mdx","sourceDirName":"module1-ros2","slug":"/module1-ros2/lesson3","permalink":"/physical-ai-textbook/docs/module1-ros2/lesson3","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module1-ros2/lesson3.mdx","tags":[],"version":"current","frontMatter":{"title":"ROS 2 Communication: Topics, Services, and Actions","description":"Dive deeper into the core communication mechanisms of ROS 2."},"sidebar":"tutorialSidebar","previous":{"title":"Building a Robot in URDF","permalink":"/physical-ai-textbook/docs/module1-ros2/lesson2"},"next":{"title":"Introduction to Robotic Simulation with Gazebo","permalink":"/physical-ai-textbook/docs/module2-simulation/lesson1"}}');var t=s(4848),o=s(8453),r=s(6540),a=s(1349),c=s(4164);const l=[{question:"What is the primary communication mechanism in ROS 2 for continuous data streams?",options:["Services","Actions","Topics","Parameters"],answer:2},{question:"Which file format is commonly used to describe a robot's physical structure in ROS?",options:["SDF","YAML","URDF","XML"],answer:2},{question:"What is the main advantage of using synthetic data from simulators like Isaac Sim?",options:["Lower computational cost","Easier to collect and annotate","Higher realism","Direct deployment to hardware"],answer:1},{question:"Which ROS 2 concept is used for long-running, goal-oriented tasks with periodic feedback?",options:["Topics","Services","Actions","Parameters"],answer:2},{question:"What does DDS stand for in the context of ROS 2?",options:["Data Distribution Service","Distributed Data System","Direct Data Stream","Dynamic Data Sync"],answer:0},{question:"What is a 'Node' in ROS 2?",options:["A physical robot","A process that performs computation","A communication channel","A type of sensor"],answer:1},{question:"Which command would you use to view active ROS 2 topics?",options:["ros2 node list","ros2 topic list","ros2 service list","ros2 param list"],answer:1},{question:"What is the purpose of an 'xacro' file in ROS?",options:["To define ROS 2 parameters","To compress URDF files","To enable macro-based XML generation for URDF","To configure ROS 2 launches"],answer:2},{question:"What is RViz used for in ROS 2?",options:["Robot programming","3D visualization of sensor data and robot state","Package management","Inter-process communication"],answer:1},{question:"Which communication pattern is best for requesting a single piece of information and waiting for a response?",options:["Topics","Services","Actions","Parameters"],answer:1}];function d(){const[e,n]=(0,r.useState)(0),[s,i]=(0,r.useState)(!1),[o,d]=(0,r.useState)(0),[u,m]=(0,r.useState)(null),[p,h]=(0,r.useState)(!1);return(0,t.jsx)("div",{className:a.A.quizContainer,children:s?(0,t.jsxs)("div",{className:a.A.scoreSection,children:["You scored ",o," out of ",l.length,(0,t.jsx)("button",{onClick:()=>{n(0),i(!1),d(0),m(null),h(!1)},className:(0,c.A)("button button--primary",a.A.resetButton),children:"Retake Quiz"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:a.A.questionSection,children:[(0,t.jsxs)("div",{className:a.A.questionCount,children:[(0,t.jsxs)("span",{children:["Question ",e+1]}),"/",l.length]}),(0,t.jsx)("div",{className:a.A.questionText,children:l[e].question})]}),(0,t.jsx)("div",{className:a.A.answerSection,children:l[e].options.map((s,r)=>(0,t.jsx)("button",{onClick:()=>{return m(s=r),s===l[e].answer&&d(o+1),void setTimeout(()=>{const s=e+1;s<l.length?(n(s),m(null)):(i(!0),h(!0))},1e3);var s},className:(0,c.A)(u===r&&(r===l[e].answer?a.A.correct:a.A.incorrect),null!==u&&r!==l[e].answer&&a.A.fadedIncorrect),disabled:null!==u,children:s},r))})]})})}const u={title:"ROS 2 Communication: Topics, Services, and Actions",description:"Dive deeper into the core communication mechanisms of ROS 2."},m="ROS 2 Communication: Topics, Services, and Actions",p={},h=[{value:"Topics: The Asynchronous Data Stream",id:"topics-the-asynchronous-data-stream",level:2},{value:"When to use Topics:",id:"when-to-use-topics",level:3},{value:"Example: Publisher and Subscriber (Conceptual)",id:"example-publisher-and-subscriber-conceptual",level:3},{value:"Services: The Synchronous Request/Response",id:"services-the-synchronous-requestresponse",level:2},{value:"When to use Services:",id:"when-to-use-services",level:3},{value:"Example: Service Server and Client (Conceptual)",id:"example-service-server-and-client-conceptual",level:3},{value:"Actions: Long-Running Goal-Oriented Tasks",id:"actions-long-running-goal-oriented-tasks",level:2},{value:"When to use Actions:",id:"when-to-use-actions",level:3},{value:"Example: Action Server and Client (Conceptual)",id:"example-action-server-and-client-conceptual",level:3},{value:"Module 1 Quiz",id:"module-1-quiz",level:2}];function f(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"ros-2-communication-topics-services-and-actions",children:"ROS 2 Communication: Topics, Services, and Actions"})}),"\n",(0,t.jsxs)(n.p,{children:["In the previous lessons, we explored the fundamentals of ROS 2 and how to define your robot's structure using URDF. Now, let's delve into the heart of ROS 2: its communication mechanisms. Understanding how ROS 2 nodes communicate is crucial for building complex robotic applications. ROS 2 provides three primary communication patterns: ",(0,t.jsx)(n.strong,{children:"Topics"}),", ",(0,t.jsx)(n.strong,{children:"Services"}),", and ",(0,t.jsx)(n.strong,{children:"Actions"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"topics-the-asynchronous-data-stream",children:"Topics: The Asynchronous Data Stream"}),"\n",(0,t.jsx)(n.p,{children:"Topics are the most common communication pattern in ROS 2, used for asynchronous, many-to-many data streaming. When a node publishes data to a topic, any other node subscribed to that topic can receive the data without direct knowledge of the publisher. This decouples the system, allowing for modular and flexible designs."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Publisher"}),": A node that sends messages to a topic."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Subscriber"}),": A node that receives messages from a topic."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Message"}),": The data structure exchanged over a topic. Each topic has a specific message type."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"when-to-use-topics",children:"When to use Topics:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Continuous data streams (sensor data, robot joint states, odometry)."}),"\n",(0,t.jsx)(n.li,{children:"One-way communication where the sender doesn't expect a direct response."}),"\n",(0,t.jsx)(n.li,{children:"Decoupled systems where multiple nodes might be interested in the same data."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"example-publisher-and-subscriber-conceptual",children:"Example: Publisher and Subscriber (Conceptual)"}),"\n",(0,t.jsxs)(n.p,{children:["Imagine a robot's camera publishing image data to a ",(0,t.jsx)(n.code,{children:"/camera/image_raw"})," topic, and an image processing node subscribing to it."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# Minimal Publisher (Conceptual)\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass MinimalPublisher(Node):\n    def __init__(self):\n        super().__init__('minimal_publisher')\n        self.publisher_ = self.create_publisher(String, 'topic', 10)\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.i = 0\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = 'Hello ROS 2: %d' % self.i\n        self.publisher_.publish(msg)\n        self.get_logger().info('Publishing: \"%s\"' % msg.data)\n        self.i += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n    minimal_publisher = MinimalPublisher()\n    rclpy.spin(minimal_publisher)\n    minimal_publisher.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# Minimal Subscriber (Conceptual)\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass MinimalSubscriber(Node):\n    def __init__(self):\n        super().__init__('minimal_subscriber')\n        self.subscription = self.create_subscription(\n            String,\n            'topic',\n            self.listener_callback,\n            10)\n        self.subscription  # prevent unused variable warning\n\n    def listener_callback(self, msg):\n        self.get_logger().info('I heard: \"%s\"' % msg.data)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    minimal_subscriber = MinimalSubscriber()\n    rclpy.spin(minimal_subscriber)\n    minimal_subscriber.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,t.jsx)(n.h2,{id:"services-the-synchronous-requestresponse",children:"Services: The Synchronous Request/Response"}),"\n",(0,t.jsx)(n.p,{children:"Services are used for synchronous, one-to-one communication where a client sends a request and expects a response from a server. This is ideal for tasks that require a direct result and can block the client until the response is received."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Service Server"}),": A node that provides a service and waits for requests."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Service Client"}),": A node that sends a request to a service server and waits for a response."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Service Definition"}),": Defines the structure of the request and response messages."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"when-to-use-services",children:"When to use Services:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:'Request/response interactions (e.g., "get current robot pose," "start a specific task").'}),"\n",(0,t.jsx)(n.li,{children:"Tasks that require a direct confirmation or result."}),"\n",(0,t.jsx)(n.li,{children:"Operations that are not time-critical or can afford to wait for a response."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"example-service-server-and-client-conceptual",children:"Example: Service Server and Client (Conceptual)"}),"\n",(0,t.jsx)(n.p,{children:'A service could be used to make a robot "add two numbers."'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# Service Server (Conceptual)\nimport rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts # Custom service definition\n\nclass MinimalService(Node):\n    def __init__(self):\n        super().__init__('minimal_service')\n        self.srv = self.create_service(AddTwoInts, 'add_two_ints', self.add_two_ints_callback)\n        self.get_logger().info('Service server ready.')\n\n    def add_two_ints_callback(self, request, response):\n        response.sum = request.a + request.b\n        self.get_logger().info(f'Incoming request: a={request.a}, b={request.b}')\n        self.get_logger().info(f'Sending response: sum={response.sum}')\n        return response\n\ndef main(args=None):\n    rclpy.init(args=args)\n    minimal_service = MinimalService()\n    rclpy.spin(minimal_service)\n    minimal_service.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# Service Client (Conceptual)\nimport rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts\nimport sys\n\nclass MinimalClientAsync(Node):\n    def __init__(self):\n        super().__init__('minimal_client_async')\n        self.cli = self.create_client(AddTwoInts, 'add_two_ints')\n        while not self.cli.wait_for_service(timeout_sec=1.0):\n            self.get_logger().info('Service not available, waiting again...')\n        self.req = AddTwoInts.Request()\n\n    def send_request(self, a, b):\n        self.req.a = a\n        self.req.b = b\n        self.future = self.cli.call_async(self.req)\n        rclpy.spin_until_future_complete(self, self.future)\n        return self.future.result()\n\ndef main(args=None):\n    rclpy.init(args=args)\n    minimal_client = MinimalClientAsync()\n    response = minimal_client.send_request(int(sys.argv[1]), int(sys.argv[2]))\n    minimal_client.get_logger().info(f'Result of add_two_ints: for {sys.argv[1]} + {sys.argv[2]} = {response.sum}')\n    minimal_client.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    if len(sys.argv) != 3:\n        print('Usage: ros2 run py_pubsub minimal_client_async A B')\n        sys.exit(1)\n    main()\n"})}),"\n",(0,t.jsx)(n.h2,{id:"actions-long-running-goal-oriented-tasks",children:"Actions: Long-Running Goal-Oriented Tasks"}),"\n",(0,t.jsx)(n.p,{children:"Actions are designed for long-running, goal-oriented tasks that require periodic feedback and can be preempted. They combine aspects of both topics (feedback) and services (request/response for goal/result)."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Action Server"}),": A node that receives goals, provides feedback, and sends a result."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Action Client"}),": A node that sends a goal, receives continuous feedback, and eventually a final result."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Action Definition"}),": Defines the structure for the goal, result, and feedback messages."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"when-to-use-actions",children:"When to use Actions:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:'Navigation tasks (e.g., "go to a specific waypoint").'}),"\n",(0,t.jsx)(n.li,{children:'Manipulation tasks (e.g., "pick up an object").'}),"\n",(0,t.jsx)(n.li,{children:"Any task where continuous monitoring and preemption are required."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"example-action-server-and-client-conceptual",children:"Example: Action Server and Client (Conceptual)"}),"\n",(0,t.jsx)(n.p,{children:'An action could be used for a robot to "count to a specific number."'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# Action Server (Conceptual) - Requires custom action definition\n# from rcl_interfaces.action import Count\n# ... similar to service/topic setup ...\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# Action Client (Conceptual) - Requires custom action definition\n# from rcl_interfaces.action import Count\n# ... similar to service/topic setup ...\n"})}),"\n",(0,t.jsx)(n.p,{children:"By mastering these three communication patterns, you gain the ability to design and implement robust and sophisticated robotic systems in ROS 2. In the next lessons, we will build upon these foundations to explore more advanced topics and real-world applications."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"module-1-quiz",children:"Module 1 Quiz"}),"\n",(0,t.jsx)(d,{})]})}function g(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(f,{...e})}):f(e)}},1349:(e,n,s)=>{s.d(n,{A:()=>i});const i={quizContainer:"quizContainer_H1nE",scoreSection:"scoreSection_qnh6",questionSection:"questionSection_f44j",questionCount:"questionCount_tA9e",questionText:"questionText_X_yQ",answerSection:"answerSection_aonW",correct:"correct__Tr1",incorrect:"incorrect_r3jN"}},8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>a});var i=s(6540);const t={},o=i.createContext(t);function r(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);