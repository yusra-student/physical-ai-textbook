"use strict";(globalThis.webpackChunkai_book=globalThis.webpackChunkai_book||[]).push([[13],{1349:(e,s,o)=>{o.d(s,{A:()=>n});const n={quizContainer:"quizContainer_H1nE",scoreSection:"scoreSection_qnh6",questionSection:"questionSection_f44j",questionCount:"questionCount_tA9e",questionText:"questionText_X_yQ",answerSection:"answerSection_aonW",correct:"correct__Tr1",incorrect:"incorrect_r3jN"}},8453:(e,s,o)=>{o.d(s,{R:()=>a,x:()=>r});var n=o(6540);const i={},t=n.createContext(i);function a(e){const s=n.useContext(t);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),n.createElement(t.Provider,{value:s},e.children)}},9523:(e,s,o)=>{o.r(s),o.d(s,{assets:()=>h,contentTitle:()=>u,default:()=>b,frontMatter:()=>m,metadata:()=>n,toc:()=>g});const n=JSON.parse('{"id":"module2-simulation/lesson3","title":"Gazebo and ROS 2 Communication","description":"Understand how to establish seamless communication between Gazebo simulations and ROS 2.","source":"@site/docs/module2-simulation/lesson3.mdx","sourceDirName":"module2-simulation","slug":"/module2-simulation/lesson3","permalink":"/physical-ai-textbook/docs/module2-simulation/lesson3","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module2-simulation/lesson3.mdx","tags":[],"version":"current","frontMatter":{"title":"Gazebo and ROS 2 Communication","description":"Understand how to establish seamless communication between Gazebo simulations and ROS 2."},"sidebar":"tutorialSidebar","previous":{"title":"Integrating Sensors in Gazebo","permalink":"/physical-ai-textbook/docs/module2-simulation/lesson2"},"next":{"title":"Introduction to NVIDIA Isaac Sim and Isaac ROS","permalink":"/physical-ai-textbook/docs/module3-isaac/lesson1"}}');var i=o(4848),t=o(8453),a=o(6540),r=o(1349),l=o(4164);const c=[{question:"What is a primary benefit of using robotic simulation?",options:["Increased hardware costs","Faster deployment to real robots","Safe and repeatable testing environments","Requires less computational power"],answer:2},{question:"Which component of Gazebo is responsible for simulating realistic rigid body dynamics?",options:["3D Graphics","Sensor Simulation","Physics Engine","Plugin Architecture"],answer:2},{question:"What file format is commonly used to describe a robot's physical structure for simulation in Gazebo?",options:["YAML","JSON","URDF/Xacro","SDF"],answer:2},{question:"Which Gazebo feature allows for extending its functionality with custom robot control or sensor models?",options:["Physics Engine","3D Graphics","ROS Integration","Plugin Architecture"],answer:3},{question:"Which of these is NOT a common sensor type simulated in robotics?",options:["LiDAR","Camera","IMU","Emotional Sensor"],answer:3},{question:"What is the purpose of the `libgazebo_ros_camera.so` plugin?",options:["To control camera movement","To render camera images in Gazebo","To publish simulated camera data to ROS 2 topics","To adjust camera focus"],answer:2},{question:"What is the name of the bridge package that facilitates communication between ROS 2 and Gazebo?",options:["ros_bridge","gazebo_ros_pkgs","ros_gz","ros2_gazebo_connector"],answer:2},{question:"Which ROS 2 message type is commonly used to send velocity commands to a differential drive robot?",options:["sensor_msgs/msg/LaserScan","geometry_msgs/msg/Twist","nav_msgs/msg/Odometry","std_msgs/msg/String"],answer:1},{question:"What tool is typically used to visualize ROS 2 sensor data (e.g., camera images, LiDAR scans)?",options:["Gazebo","rviz2","VS Code","rqt_graph"],answer:1},{question:"When integrating a sensor into a robot's URDF/Xacro model, where do Gazebo-specific sensor definitions reside?",options:["Inside the `<link>` tag","Inside the `<joint>` tag","Within a `<gazebo reference='link_name'>` block","In a separate `sensor.yaml` file"],answer:2}];function d(){const[e,s]=(0,a.useState)(0),[o,n]=(0,a.useState)(!1),[t,d]=(0,a.useState)(0),[m,u]=(0,a.useState)(null),[h,g]=(0,a.useState)(!1);return(0,i.jsx)("div",{className:r.A.quizContainer,children:o?(0,i.jsxs)("div",{className:r.A.scoreSection,children:["You scored ",t," out of ",c.length,(0,i.jsx)("button",{onClick:()=>{s(0),n(!1),d(0),u(null),g(!1)},className:(0,l.A)("button button--primary",r.A.resetButton),children:"Retake Quiz"})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:r.A.questionSection,children:[(0,i.jsxs)("div",{className:r.A.questionCount,children:[(0,i.jsxs)("span",{children:["Question ",e+1]}),"/",c.length]}),(0,i.jsx)("div",{className:r.A.questionText,children:c[e].question})]}),(0,i.jsx)("div",{className:r.A.answerSection,children:c[e].options.map((o,a)=>(0,i.jsx)("button",{onClick:()=>{return u(o=a),o===c[e].answer&&d(t+1),void setTimeout(()=>{const o=e+1;o<c.length?(s(o),u(null)):(n(!0),g(!0))},1e3);var o},className:(0,l.A)(m===a&&(a===c[e].answer?r.A.correct:r.A.incorrect),null!==m&&a!==c[e].answer&&r.A.fadedIncorrect),disabled:null!==m,children:o},a))})]})})}const m={title:"Gazebo and ROS 2 Communication",description:"Understand how to establish seamless communication between Gazebo simulations and ROS 2."},u="Gazebo and ROS 2 Communication",h={},g=[{value:"The Role of <code>ros_gz</code> Bridge",id:"the-role-of-ros_gz-bridge",level:2},{value:"Reading Sensor Data from Gazebo in ROS 2",id:"reading-sensor-data-from-gazebo-in-ros-2",level:2},{value:"Example: Subscribing to a Camera Image Topic",id:"example-subscribing-to-a-camera-image-topic",level:3},{value:"Sending Commands to a Simulated Robot from ROS 2",id:"sending-commands-to-a-simulated-robot-from-ros-2",level:2},{value:"Example: Publishing Velocity Commands",id:"example-publishing-velocity-commands",level:3},{value:"Module 2 Quiz",id:"module-2-quiz",level:2}];function p(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"gazebo-and-ros-2-communication",children:"Gazebo and ROS 2 Communication"})}),"\n",(0,i.jsx)(s.p,{children:"In the previous lessons, we introduced robotic simulation with Gazebo and learned how to integrate various sensors into our simulated robots. Now, it's time to bridge the gap between the simulated world and our robotic software by understanding how Gazebo and ROS 2 communicate. This seamless integration is what makes Gazebo a powerful tool for ROS developers."}),"\n",(0,i.jsxs)(s.h2,{id:"the-role-of-ros_gz-bridge",children:["The Role of ",(0,i.jsx)(s.code,{children:"ros_gz"})," Bridge"]}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"ros_gz"})," (formerly ",(0,i.jsx)(s.code,{children:"ros_ign"}),") bridge is a crucial package that facilitates communication between ROS 2 and Gazebo (specifically, Gazebo Fortress and later). It provides a set of ROS 2 nodes that translate messages between Gazebo's native topic system and ROS 2 topics. This allows your ROS 2 nodes to publish commands to a simulated robot in Gazebo and subscribe to sensor data coming from the simulation."]}),"\n",(0,i.jsx)(s.p,{children:"The bridge typically handles the conversion of various message types, such as:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Joint commands (e.g., ",(0,i.jsx)(s.code,{children:"std_msgs/msg/Float64"})," for position or velocity control)"]}),"\n",(0,i.jsxs)(s.li,{children:["Odometry data (e.g., ",(0,i.jsx)(s.code,{children:"nav_msgs/msg/Odometry"}),")"]}),"\n",(0,i.jsxs)(s.li,{children:["Sensor data (e.g., ",(0,i.jsx)(s.code,{children:"sensor_msgs/msg/Image"}),", ",(0,i.jsx)(s.code,{children:"sensor_msgs/msg/LaserScan"}),", ",(0,i.jsx)(s.code,{children:"sensor_msgs/msg/Imu"}),")"]}),"\n",(0,i.jsxs)(s.li,{children:["Transforms (",(0,i.jsx)(s.code,{children:"tf2_msgs/msg/TFMessage"}),")"]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"reading-sensor-data-from-gazebo-in-ros-2",children:"Reading Sensor Data from Gazebo in ROS 2"}),"\n",(0,i.jsxs)(s.p,{children:["When you add a sensor to your robot model in Gazebo using the ",(0,i.jsx)(s.code,{children:"libgazebo_ros_sensor"})," or specific sensor plugins (like ",(0,i.jsx)(s.code,{children:"libgazebo_ros_camera.so"}),", ",(0,i.jsx)(s.code,{children:"libgazebo_ros_laser.so"}),"), they automatically publish data to ROS 2 topics."]}),"\n",(0,i.jsx)(s.h3,{id:"example-subscribing-to-a-camera-image-topic",children:"Example: Subscribing to a Camera Image Topic"}),"\n",(0,i.jsxs)(s.p,{children:["Let's assume you have a camera sensor configured in your robot model that publishes to ",(0,i.jsx)(s.code,{children:"/camera/image_raw"}),". A simple ROS 2 Python node can subscribe to this topic to receive image data:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import Image\nfrom cv_bridge import CvBridge\nimport cv2\n\nclass ImageSubscriber(Node):\n    def __init__(self):\n        super().__init__('image_subscriber')\n        self.subscription = self.create_subscription(\n            Image,\n            '/camera/image_raw',\n            self.listener_callback,\n            10)\n        self.subscription  # prevent unused variable warning\n        self.br = CvBridge()\n        self.get_logger().info('Image subscriber node started.')\n\n    def listener_callback(self, data):\n        self.get_logger().info('Receiving video frame')\n        current_frame = self.br.imgmsg_to_cv2(data)\n        cv2.imshow(\"camera\", current_frame)\n        cv2.waitKey(1)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    image_subscriber = ImageSubscriber()\n    rclpy.spin(image_subscriber)\n    image_subscriber.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsxs)(s.p,{children:["This node subscribes to the ",(0,i.jsx)(s.code,{children:"/camera/image_raw"})," topic, converts the ROS ",(0,i.jsx)(s.code,{children:"Image"})," message to an OpenCV image, and displays it."]}),"\n",(0,i.jsx)(s.h2,{id:"sending-commands-to-a-simulated-robot-from-ros-2",children:"Sending Commands to a Simulated Robot from ROS 2"}),"\n",(0,i.jsxs)(s.p,{children:["Similarly, you can control your simulated robot by publishing commands to specific ROS 2 topics that Gazebo is listening to. For example, to control the velocity of a robot, you might publish to a ",(0,i.jsx)(s.code,{children:"cmd_vel"})," topic."]}),"\n",(0,i.jsx)(s.h3,{id:"example-publishing-velocity-commands",children:"Example: Publishing Velocity Commands"}),"\n",(0,i.jsxs)(s.p,{children:["To make a differential drive robot move, you would typically publish ",(0,i.jsx)(s.code,{children:"geometry_msgs/msg/Twist"})," messages to a ",(0,i.jsx)(s.code,{children:"/cmd_vel"})," topic."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom geometry_msgs.msg import Twist\nimport time\n\nclass VelocityPublisher(Node):\n    def __init__(self):\n        super().__init__('velocity_publisher')\n        self.publisher_ = self.create_publisher(Twist, '/cmd_vel', 10)\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.i = 0\n        self.get_logger().info('Velocity publisher node started.')\n\n    def timer_callback(self):\n        msg = Twist()\n        msg.linear.x = 0.2  # Move forward at 0.2 m/s\n        msg.angular.z = 0.0 # Don't turn\n        self.publisher_.publish(msg)\n        self.get_logger().info(f'Publishing: Linear X={msg.linear.x}, Angular Z={msg.angular.z}')\n        self.i += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n    velocity_publisher = VelocityPublisher()\n    rclpy.spin(velocity_publisher)\n    velocity_publisher.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsxs)(s.p,{children:["This node publishes a ",(0,i.jsx)(s.code,{children:"Twist"})," message every 0.5 seconds, commanding the robot to move forward."]}),"\n",(0,i.jsx)(s.p,{children:"By understanding these communication patterns, you can develop sophisticated control algorithms and perception systems for your simulated robots, paving the way for their deployment in the real world. In the next phase, we will focus on developing practical code examples for these concepts."}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"module-2-quiz",children:"Module 2 Quiz"}),"\n",(0,i.jsx)(d,{})]})}function b(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(p,{...e})}):p(e)}}}]);